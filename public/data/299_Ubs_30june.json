[
    {
        "id": 949,
        "title": "SQL: Tax Calculation for Online Tax Application",
        "problem_statement": "<h1>SQL: Tax Calculation for Online Tax Application</h1>\r\n\r\n<h2>Problem Description</h2>\r\n<p>In the world of finance, tax calculation is a fundamental operation. A development team is working on an online tax application designed to simplify tax calculations for users. One of the key features they aim to implement is a tax calculation mechanism. This mechanism will calculate a fixed 20% tax on the total income for each account in the system.</p>\r\n<p>The results should have the following columns: <code>iban</code>, <code>total_income</code>, <code>tax_rate</code>, <code>calculated_tax</code>.</p>\r\n<ul>\r\n    <li><code>iban</code> - The IBAN of the account</li>\r\n    <li><code>total_income</code> - The total income for the account, with two decimal places, including trailing zeros if necessary, e.g., 500.00</li>\r\n    <li><code>tax_rate</code> - The tax rate applied, which is a fixed text '20%'</li>\r\n    <li><code>calculated_tax</code> - The tax calculated, rounded to two decimal places, including trailing zeros if necessary, e.g., 500.00</li>\r\n</ul>\r\n<p>The results should be sorted in ascending order by <code>iban</code>.</p>\r\n\r\n<h2>Note</h2>\r\n<ul>\r\n    <li>Only income in 2023 should be included.</li>\r\n</ul>\r\n\r\n<h2>Schema</h2>\r\n<pre><code class='language-text'>Table: accounts\r\n+-----------+--------------+-------------+---------------------------------+\r\n| Name      | Type         | Constraints | Description                     |\r\n+-----------+--------------+-------------+---------------------------------+\r\n| id        | INT          | PRIMARY KEY | The identifier of the account   |\r\n| iban      | VARCHAR(255) |             | The IBAN of the account         |\r\n+-----------+--------------+-------------+---------------------------------+\r\n\r\nTable: income\r\n+-------------+--------------+-------------------------------------+-----------------------------+\r\n| Name        | Type         | Constraints                         | Description                 |\r\n+-------------+--------------+-------------------------------------+-----------------------------+\r\n| account_id  | INT          | FOREIGN KEY(account_id => accounts.id) | The reference to the account|\r\n| dt          | VARCHAR(19)  |                                     | The date and time of income |\r\n| amount      | DECIMAL(6,2) |                                     | The income amount           |\r\n+-------------+--------------+-------------------------------------+-----------------------------+</code></pre>\r\n\r\n<h2>Sample Data Tables</h2>\r\n<pre><code class='language-text'>Table: accounts\r\n+----+------------------------------------+\r\n| id | iban                               |\r\n+----+------------------------------------+\r\n| 1  | FR55 4477 6154 73ND TN3F HMOU T36  |\r\n| 2  | DK46 1272 1831 2573 01             |\r\n| 3  | RS53 5237 5794 6016 5411 43        |\r\n+----+------------------------------------+\r\n\r\nTable: income\r\n+------------+---------------------+----------+\r\n| account_id | dt                  | amount   |\r\n+------------+---------------------+----------+\r\n| 1          | 2022-12-31 10:03:42 | 2779.19  |\r\n| 1          | 2023-02-04 08:50:14 | 1777.68  |\r\n| 1          | 2023-02-13 04:22:07 | 1954.81  |\r\n| 1          | 2023-03-04 14:46:04 | 1547.79  |\r\n| 1          | 2023-05-23 15:42:13 | 1208.49  |\r\n| 1          | 2023-05-24 23:24:07 | 1521.72  |\r\n| 1          | 2023-07-28 11:01:46 | 1792.75  |\r\n| 1          | 2023-12-07 14:19:09 | 2374.25  |\r\n| 1          | 2024-01-27 05:55:36 | 2803.39  |\r\n| 2          | 2022-12-03 18:04:34 | 1826.65  |\r\n| 2          | 2023-02-17 00:59:57 | 3074.11  |\r\n| 2          | 2023-03-01 08:17:15 | 1007.30  |\r\n| 2          | 2023-08-19 09:16:41 | 4515.04  |\r\n| 2          | 2024-01-08 04:14:22 | 3321.78  |\r\n| 2          | 2024-01-10 15:16:28 | 2033.87  |\r\n| 3          | 2023-05-09 07:28:27 | 3158.66  |\r\n| 3          | 2023-05-22 04:39:34 | 3851.20  |\r\n| 3          | 2023-07-21 19:51:14 | 4152.29  |\r\n| 3          | 2023-10-05 05:42:49 | 4722.20  |\r\n| 3          | 2023-11-11 02:42:59 | 1592.16  |\r\n+------------+---------------------+----------+</code></pre>\r\n\r\n<h2>Examples</h2>\r\n<h3>Example 1:</h3>\r\n<pre><code class='language-text'>Input:\r\n(See Schema and Sample Data Tables above)\r\n\r\nOutput:\r\n+------------------------------------+--------------+----------+----------------+\r\n| iban                               | total_income | tax_rate | calculated_tax |\r\n+------------------------------------+--------------+----------+----------------+\r\n| DK46 1272 1831 2573 01             | 8596.45      | 20%      | 1719.29        |\r\n| FR55 4477 6154 73ND TN3F HMOU T36  | 12177.49     | 20%      | 2435.50        |\r\n| RS53 5237 5794 6016 5411 43        | 17476.51     | 20%      | 3495.30        |\r\n+------------------------------------+--------------+----------+----------------+</code></pre>",
        "google_doc_link": null,
        "solution_code": null,
        "company_name": "Ubs_30june",
        "company_id": 299
    }
]